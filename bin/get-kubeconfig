#!/usr/bin/env bash
set -xeEuo pipefail

main() {
  host="$1"
  output="${2:-"-"}"
  ssh "rancher@$host" cat /etc/rancher/k3s/k3s.yaml | sed "s/127.0.0.1/$host/g" | redirect "$output"
}

redirect() {
  [[ "$1" == "-" ]] && return 0
  > "$1"
}

main "${@}"
